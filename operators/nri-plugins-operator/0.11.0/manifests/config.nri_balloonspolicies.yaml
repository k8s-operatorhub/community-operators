apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.18.0
  creationTimestamp: null
  name: balloonspolicies.config.nri
spec:
  group: config.nri
  names:
    kind: BalloonsPolicy
    listKind: BalloonsPolicyList
    plural: balloonspolicies
    singular: balloonspolicy
  scope: Namespaced
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        description: BalloonsPolicy represents the configuration for the balloons
          policy.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: BalloonsPolicySpec describes a balloons policy.
            properties:
              agent:
                default:
                  nodeResourceTopology: true
                description: AgentConfig provides access to configuration data for
                  the agent.
                properties:
                  nodeResourceTopology:
                    description: |-
                      NodeResourceTopology enables support for exporting resource usage using
                      NodeResourceTopology Custom Resources.
                    type: boolean
                  podResourceAPI:
                    description: PodResourceAPI enables support for querying kubelet
                      Pod Resource API.
                    type: boolean
                type: object
              allocatorTopologyBalancing:
                description: |-
                  If AllocatorTopologyBalancing is true, balloons are
                  allocated and resized so that all topology elements
                  (packages, dies, numa nodes, cores) have roughly same
                  amount of allocations. The default is false: balloons are
                  packed tightly to optimize power efficiency. The value set
                  here can be overridden with the balloon type specific
                  setting with the same name.
                type: boolean
              availableResources:
                additionalProperties:
                  type: string
                description: Available/allowed (CPU) resources to use.
                type: object
              balloonTypes:
                description: BallonDefs contains balloon type definitions.
                items:
                  description: BalloonDef contains a balloon definition.
                  properties:
                    allocatorPriority:
                      default: high
                      description: |-
                        AllocatorPriority (High, Normal, Low, None)
                        This parameter is passed to CPU allocator when creating or
                        resizing a balloon. At init, balloons with highest priority
                        CPUs are allocated first.
                      enum:
                      - high
                      - normal
                      - low
                      - none
                      type: string
                    allocatorTopologyBalancing:
                      description: |-
                        AllocatorTopologyBalancing is the balloon type specific
                        parameter of the policy level parameter with the same name.
                      type: boolean
                    components:
                      description: |-
                        Components is a list of component properties. Every
                        component has a balloonType property according to which
                        CPUs are allocated for that component. Specifying the
                        Components list makes this a composite balloon type whose
                        instances uses all CPUs of its component instances, and no
                        other CPUs.
                      items:
                        description: BalloonDefComponent contains a balloon component
                          definition.
                        properties:
                          balloonType:
                            description: |-
                              BalloonType is the name of the balloon type of this
                              component. It must match the name of a balloon type
                              defined in the ballonTypes of the policy.
                            type: string
                        required:
                        - balloonType
                        type: object
                      type: array
                    cpuClass:
                      description: |-
                        CpuClass controls how CPUs of a balloon are (re)configured
                        whenever a balloon is created, inflated or deflated.
                      type: string
                    groupBy:
                      description: |-
                        GroupBy groups containers into same balloon instances if
                        their GroupBy expressions evaluate to the same group.
                        Expressions are strings where key references like
                        ${pod/labels/mylabel} will be substituted with
                        corresponding values.
                      type: string
                    hideHyperthreads:
                      description: |-
                        HideHyperthreads allows containers in a balloon use only
                        one hyperthread from each physical CPU core in the
                        balloon. For instance, if a balloon contains 16 logical
                        CPUs from 8 physical cores and this option is true, then
                        containers in the balloon will be allowed to use 8 logical
                        CPUs, one from each physical core. This option is best used
                        with PreferSpreadOnPhysicalCores=false in order to allocate
                        all hyperthreads of each physical core into the same
                        balloon, but allow containers to use only one hyperthread
                        from each core. This will ensure that hidden hyperthreads
                        will remain completely idle as they cannot be allocated to
                        other balloons.
                      type: boolean
                    loads:
                      description: |-
                        Loads is a list of loadClasses that describe load generated
                        by containers in these balloons. CPUs are selected to
                        balloons with loads so that overloading any part of the
                        system is avoided.
                      items:
                        type: string
                      type: array
                      x-kubernetes-list-type: set
                    matchExpressions:
                      description: |-
                        MatchExpressions specifies one or more expressions which are evaluated
                        to see if a container should be assigned into balloon instances from
                        this definition.
                      items:
                        description: |-
                          Expression describes some runtime-evaluated condition. An expression
                          consists of a key, an operator and a set of values. An expression is
                          evaluated against an object which implements the Evaluable interface.
                          Evaluating an expression consists of looking up the value for the key
                          in the object, then using the operator to check it against the values
                          of the expression. The result is a single boolean value. An object is
                          said to satisfy the evaluated expression if this value is true. An
                          expression can contain 0, 1 or more values depending on the operator.
                        properties:
                          key:
                            description: Key is the expression key.
                            type: string
                          operator:
                            description: Op is the expression operator.
                            enum:
                            - Equals
                            - NotEqual
                            - In
                            - NotIn
                            - Exists
                            - NotExist
                            - AlwaysTrue
                            - Matches
                            - MatchesNot
                            - MatchesAny
                            - MatchesNone
                            type: string
                          values:
                            description: Values contains the values the key value
                              is evaluated against.
                            items:
                              type: string
                            type: array
                        required:
                        - key
                        - operator
                        type: object
                      type: array
                    maxBalloons:
                      description: |-
                        MaxBalloons is the maximum number of balloon instances that
                        is allowed to co-exist. If reached, new balloons cannot be
                        created anymore.
                      type: integer
                    maxCPUs:
                      description: |-
                        MaxCpus specifies the maximum number of CPUs exclusively
                        usable by containers in a balloon. Balloon size will not be
                        inflated larger than MaxCpus.
                      type: integer
                    memoryTypes:
                      description: |-
                        MemoryTypes lists memory types allowed to containers in a
                        balloon. Supported types are: DRAM, HBM, PMEM. By default
                        all memory types in the system are allowed.
                      items:
                        type: string
                        x-kubernetes-validations:
                        - messageExpression: '"invalid memory type: " + self + ",
                            expected DRAM, HBM, or PMEM"'
                          rule: self == 'DRAM' || self == 'HBM' || self == 'PMEM'
                      type: array
                      x-kubernetes-list-type: set
                    minBalloons:
                      description: |-
                        MinBalloons is the number of balloon instances that always
                        exist even if they would become empty. At init this number
                        of instances will be created before assigning any
                        containers.
                      type: integer
                    minCPUs:
                      description: |-
                        MinCpus specifies the minimum number of CPUs exclusively
                        usable by containers in a balloon. When new balloon is created,
                        this will be the number of CPUs reserved for it even if a container
                        would request less.
                      type: integer
                    name:
                      description: Name of the balloon definition.
                      type: string
                    namespaces:
                      description: |-
                        Namespaces control which namespaces are assigned into
                        balloon instances from this definition. This is used by
                        namespace assign methods.
                      items:
                        type: string
                      type: array
                    pinMemory:
                      description: |-
                        PinMemory controls pinning containers to memory nodes.
                        Overrides the policy level PinMemory setting in this balloon type.
                      type: boolean
                    preferCloseToDevices:
                      description: |-
                        PreferCloseToDevices: prefer creating new balloons of this
                        type close to listed devices.
                      items:
                        type: string
                      type: array
                    preferCoreType:
                      description: |-
                        preferCoreType: prefer performance or efficient (P/E) CPU cores on
                        hybrid architectures.
                      enum:
                      - efficient
                      - performance
                      type: string
                    preferIsolCpus:
                      default: false
                      description: 'preferIsolCpus: prefer kernel isolated cpus'
                      type: boolean
                    preferNewBalloons:
                      description: |-
                        PreferNewBalloons: prefer creating new balloons over adding
                        containers to existing balloons. The default is false:
                        prefer using filling free capacity and possibly inflating
                        existing balloons before creating new ones.
                      type: boolean
                    preferPerNamespaceBalloon:
                      description: |-
                        PreferPerNamespaceBalloon: if true, containers in different
                        namespaces are preferably placed in separate balloons,
                        even if the balloon type is the same for all of them. On
                        the other hand, containers in the same namespace will be
                        placed in the same balloon instances. The default is false:
                        namespaces have no effect on placement.
                      type: boolean
                    preferSpreadOnPhysicalCores:
                      description: |-
                        PreferSpreadOnPhysicalCores is the balloon type specific
                        parameter of the policy level parameter with the same name.
                      type: boolean
                    preferSpreadingPods:
                      description: |-
                        PreferSpreadingPods: containers of the same pod may be
                        placed on separate balloons. The default is false: prefer
                        placing containers of a pod to the same balloon(s).
                      type: boolean
                    shareIdleCPUsInSame:
                      description: |-
                        ShareIdleCpusInSame <topology-level>: if there are idle
                        CPUs, that is CPUs not in any balloon, in the same
                        <topology-level> as any CPU in the balloon, then allow
                        workloads to run on those (shared) CPUs in addition to the
                        (dedicated) CPUs of the balloon.
                      enum:
                      - ""
                      - system
                      - package
                      - die
                      - numa
                      - l2cache
                      - core
                      - thread
                      type: string
                    showContainersInNrt:
                      description: |-
                        ShowContainersInNrt controls showing containers and their
                        resource affinities as part of
                        NodeResourceTopology. Overrides the policy level
                        ShowContainersInNrt setting for containers in this balloon
                        type. Requires agent:NodeResourceTopology. Note that this
                        may generate a lot of traffic and large CR object updates
                        to Kubernetes API server.
                      type: boolean
                  required:
                  - name
                  type: object
                type: array
              control:
                properties:
                  blockio:
                    description: |-
                      Config provides runtime configuration for class based block I/O
                      prioritization and throttling.
                    properties:
                      enable:
                        description: |-
                          Enable class based block I/O prioritization and throttling. When
                          enabled, policy implementations can adjust block I/O priority by
                          assigning containers to block I/O priority classes. Additionally
                          you need to set up your cluster nodes' runtimes with the desired
                          block I/O class configuration.
                        type: boolean
                      usePodQoSAsDefaultClass:
                        description: |-
                          usePodQoSAsDefaultClass controls whether a container's Pod QoS
                          class is used as its block I/O class, if this is otherwise unset.
                        type: boolean
                    type: object
                  cpu:
                    properties:
                      classes:
                        additionalProperties:
                          properties:
                            disabledCstates:
                              description: DisabledCstates lists C-states disabled
                                for this class.
                              items:
                                type: string
                              type: array
                            energyPerformancePreference:
                              description: EnergyPerformancePreference for CPUs in
                                this class.
                              type: integer
                            freqGovernor:
                              description: CPUFreq Governor for this class.
                              type: string
                            maxFreq:
                              description: MaxFreq is the maximum frequency for this
                                class.
                              type: integer
                            minFreq:
                              description: MinFreq is the minimum frequency for this
                                class.
                              type: integer
                            uncoreMaxFreq:
                              description: UncoreMaxFreq is the maximum uncore frequency
                                for this class.
                              type: integer
                            uncoreMinFreq:
                              description: UncoreMinFreq is the minimum uncore frequency
                                for this class.
                              type: integer
                          type: object
                        type: object
                    required:
                    - classes
                    type: object
                  rdt:
                    description: |-
                      Config provides runtime configuration for class based cache allocation
                      and memory bandwidth control.
                    properties:
                      enable:
                        description: |-
                          Enable class based cache allocation and memory bandwidth control.
                          When enabled, policy implementations can adjust cache allocation
                          and memory bandwidth by assigning containers to RDT classes.
                        type: boolean
                      force:
                        description: Force indicates if the configuration should be
                          forced to goresctrl.
                        type: boolean
                      options:
                        description: Options container common goresctrl/rdt settings.
                        properties:
                          l2:
                            description: CatOptions contains the common settings for
                              cache allocation.
                            properties:
                              optional:
                                type: boolean
                            required:
                            - optional
                            type: object
                          l3:
                            description: CatOptions contains the common settings for
                              cache allocation.
                            properties:
                              optional:
                                type: boolean
                            required:
                            - optional
                            type: object
                          mb:
                            description: MbOptions contains the common settings for
                              memory bandwidth allocation.
                            properties:
                              optional:
                                type: boolean
                            required:
                            - optional
                            type: object
                        type: object
                      partitions:
                        additionalProperties:
                          description: PartitionConfig provides configuration for
                            a single cache partition.
                          properties:
                            classes:
                              additionalProperties:
                                description: ClassConfig provides configuration for
                                  a single named cache CLOS/class.
                                properties:
                                  l2Allocation:
                                    additionalProperties:
                                      description: "CacheIdCatConfig is the cache
                                        allocation configuration for one cache id.\nCode
                                        and Data represent an optional configuration
                                        for separate code and data\npaths and only
                                        have effect when RDT CDP (Code and Data Prioritization)
                                        is\nenabled in the system. Code and Data go
                                        in tandem so that both or neither\nmust be
                                        specified - only specifying the other is considered
                                        a configuration\nerror.\n\n\tTODO(klihub):
                                        Ideally we'd have a validation rule ensuring
                                        that either\n\tunified or code+data are set
                                        here. I tried that using a CEL-expression\n\tbut
                                        couldn't avoid hitting the complexity estimation
                                        limit (even with\n\textra MaxProperties limits
                                        thrown in). Maybe we'll be able to do that\n\teventually
                                        with https://github.com/kubernetes-sigs/controller-tools/pull/1212"
                                      properties:
                                        code:
                                          description: |-
                                            CacheProportion specifies a share of the available cache lines.
                                            Supported formats:

                                            - percentage, e.g. `50%`
                                            - percentage range, e.g. `50-60%`
                                            - bit numbers, e.g. `0-5`, `2,3`, must contain one contiguous block of bits set
                                            - hex bitmask, e.g. `0xff0`, must contain one contiguous block of bits set
                                          type: string
                                        data:
                                          description: |-
                                            CacheProportion specifies a share of the available cache lines.
                                            Supported formats:

                                            - percentage, e.g. `50%`
                                            - percentage range, e.g. `50-60%`
                                            - bit numbers, e.g. `0-5`, `2,3`, must contain one contiguous block of bits set
                                            - hex bitmask, e.g. `0xff0`, must contain one contiguous block of bits set
                                          type: string
                                        unified:
                                          description: |-
                                            CacheProportion specifies a share of the available cache lines.
                                            Supported formats:

                                            - percentage, e.g. `50%`
                                            - percentage range, e.g. `50-60%`
                                            - bit numbers, e.g. `0-5`, `2,3`, must contain one contiguous block of bits set
                                            - hex bitmask, e.g. `0xff0`, must contain one contiguous block of bits set
                                          type: string
                                      type: object
                                    description: CatConfig contains the L2 or L3 cache
                                      allocation configuration for one partition or
                                      class.
                                    type: object
                                  l3Allocation:
                                    additionalProperties:
                                      description: "CacheIdCatConfig is the cache
                                        allocation configuration for one cache id.\nCode
                                        and Data represent an optional configuration
                                        for separate code and data\npaths and only
                                        have effect when RDT CDP (Code and Data Prioritization)
                                        is\nenabled in the system. Code and Data go
                                        in tandem so that both or neither\nmust be
                                        specified - only specifying the other is considered
                                        a configuration\nerror.\n\n\tTODO(klihub):
                                        Ideally we'd have a validation rule ensuring
                                        that either\n\tunified or code+data are set
                                        here. I tried that using a CEL-expression\n\tbut
                                        couldn't avoid hitting the complexity estimation
                                        limit (even with\n\textra MaxProperties limits
                                        thrown in). Maybe we'll be able to do that\n\teventually
                                        with https://github.com/kubernetes-sigs/controller-tools/pull/1212"
                                      properties:
                                        code:
                                          description: |-
                                            CacheProportion specifies a share of the available cache lines.
                                            Supported formats:

                                            - percentage, e.g. `50%`
                                            - percentage range, e.g. `50-60%`
                                            - bit numbers, e.g. `0-5`, `2,3`, must contain one contiguous block of bits set
                                            - hex bitmask, e.g. `0xff0`, must contain one contiguous block of bits set
                                          type: string
                                        data:
                                          description: |-
                                            CacheProportion specifies a share of the available cache lines.
                                            Supported formats:

                                            - percentage, e.g. `50%`
                                            - percentage range, e.g. `50-60%`
                                            - bit numbers, e.g. `0-5`, `2,3`, must contain one contiguous block of bits set
                                            - hex bitmask, e.g. `0xff0`, must contain one contiguous block of bits set
                                          type: string
                                        unified:
                                          description: |-
                                            CacheProportion specifies a share of the available cache lines.
                                            Supported formats:

                                            - percentage, e.g. `50%`
                                            - percentage range, e.g. `50-60%`
                                            - bit numbers, e.g. `0-5`, `2,3`, must contain one contiguous block of bits set
                                            - hex bitmask, e.g. `0xff0`, must contain one contiguous block of bits set
                                          type: string
                                      type: object
                                    description: CatConfig contains the L2 or L3 cache
                                      allocation configuration for one partition or
                                      class.
                                    type: object
                                  mbAllocation:
                                    additionalProperties:
                                      description: |-
                                        CacheIdMbaConfig is the memory bandwidth configuration for one cache id.
                                        It's an array of at most two values, specifying separate values to be used
                                        for percentage based and MBps based memory bandwidth allocation. For
                                        example, `{"80%", "1000MBps"}` would allocate 80% if percentage based
                                        allocation is used by the Linux kernel, or 1000 MBps in case MBps based
                                        allocation is in use.
                                      items:
                                        description: |-
                                          MbProportion specifies a share of available memory bandwidth. It's an
                                          integer value followed by a unit. Two units are supported:

                                          - percentage, e.g. `80%`
                                          - MBps, e.g. `1000MBps`
                                        type: string
                                      type: array
                                    description: MbaConfig contains the memory bandwidth
                                      configuration for one partition or class.
                                    type: object
                                type: object
                              type: object
                            l2Allocation:
                              additionalProperties:
                                description: "CacheIdCatConfig is the cache allocation
                                  configuration for one cache id.\nCode and Data represent
                                  an optional configuration for separate code and
                                  data\npaths and only have effect when RDT CDP (Code
                                  and Data Prioritization) is\nenabled in the system.
                                  Code and Data go in tandem so that both or neither\nmust
                                  be specified - only specifying the other is considered
                                  a configuration\nerror.\n\n\tTODO(klihub): Ideally
                                  we'd have a validation rule ensuring that either\n\tunified
                                  or code+data are set here. I tried that using a
                                  CEL-expression\n\tbut couldn't avoid hitting the
                                  complexity estimation limit (even with\n\textra
                                  MaxProperties limits thrown in). Maybe we'll be
                                  able to do that\n\teventually with https://github.com/kubernetes-sigs/controller-tools/pull/1212"
                                properties:
                                  code:
                                    description: |-
                                      CacheProportion specifies a share of the available cache lines.
                                      Supported formats:

                                      - percentage, e.g. `50%`
                                      - percentage range, e.g. `50-60%`
                                      - bit numbers, e.g. `0-5`, `2,3`, must contain one contiguous block of bits set
                                      - hex bitmask, e.g. `0xff0`, must contain one contiguous block of bits set
                                    type: string
                                  data:
                                    description: |-
                                      CacheProportion specifies a share of the available cache lines.
                                      Supported formats:

                                      - percentage, e.g. `50%`
                                      - percentage range, e.g. `50-60%`
                                      - bit numbers, e.g. `0-5`, `2,3`, must contain one contiguous block of bits set
                                      - hex bitmask, e.g. `0xff0`, must contain one contiguous block of bits set
                                    type: string
                                  unified:
                                    description: |-
                                      CacheProportion specifies a share of the available cache lines.
                                      Supported formats:

                                      - percentage, e.g. `50%`
                                      - percentage range, e.g. `50-60%`
                                      - bit numbers, e.g. `0-5`, `2,3`, must contain one contiguous block of bits set
                                      - hex bitmask, e.g. `0xff0`, must contain one contiguous block of bits set
                                    type: string
                                type: object
                              description: CatConfig contains the L2 or L3 cache allocation
                                configuration for one partition or class.
                              type: object
                            l3Allocation:
                              additionalProperties:
                                description: "CacheIdCatConfig is the cache allocation
                                  configuration for one cache id.\nCode and Data represent
                                  an optional configuration for separate code and
                                  data\npaths and only have effect when RDT CDP (Code
                                  and Data Prioritization) is\nenabled in the system.
                                  Code and Data go in tandem so that both or neither\nmust
                                  be specified - only specifying the other is considered
                                  a configuration\nerror.\n\n\tTODO(klihub): Ideally
                                  we'd have a validation rule ensuring that either\n\tunified
                                  or code+data are set here. I tried that using a
                                  CEL-expression\n\tbut couldn't avoid hitting the
                                  complexity estimation limit (even with\n\textra
                                  MaxProperties limits thrown in). Maybe we'll be
                                  able to do that\n\teventually with https://github.com/kubernetes-sigs/controller-tools/pull/1212"
                                properties:
                                  code:
                                    description: |-
                                      CacheProportion specifies a share of the available cache lines.
                                      Supported formats:

                                      - percentage, e.g. `50%`
                                      - percentage range, e.g. `50-60%`
                                      - bit numbers, e.g. `0-5`, `2,3`, must contain one contiguous block of bits set
                                      - hex bitmask, e.g. `0xff0`, must contain one contiguous block of bits set
                                    type: string
                                  data:
                                    description: |-
                                      CacheProportion specifies a share of the available cache lines.
                                      Supported formats:

                                      - percentage, e.g. `50%`
                                      - percentage range, e.g. `50-60%`
                                      - bit numbers, e.g. `0-5`, `2,3`, must contain one contiguous block of bits set
                                      - hex bitmask, e.g. `0xff0`, must contain one contiguous block of bits set
                                    type: string
                                  unified:
                                    description: |-
                                      CacheProportion specifies a share of the available cache lines.
                                      Supported formats:

                                      - percentage, e.g. `50%`
                                      - percentage range, e.g. `50-60%`
                                      - bit numbers, e.g. `0-5`, `2,3`, must contain one contiguous block of bits set
                                      - hex bitmask, e.g. `0xff0`, must contain one contiguous block of bits set
                                    type: string
                                type: object
                              description: CatConfig contains the L2 or L3 cache allocation
                                configuration for one partition or class.
                              type: object
                            mbAllocation:
                              additionalProperties:
                                description: |-
                                  CacheIdMbaConfig is the memory bandwidth configuration for one cache id.
                                  It's an array of at most two values, specifying separate values to be used
                                  for percentage based and MBps based memory bandwidth allocation. For
                                  example, `{"80%", "1000MBps"}` would allocate 80% if percentage based
                                  allocation is used by the Linux kernel, or 1000 MBps in case MBps based
                                  allocation is in use.
                                items:
                                  description: |-
                                    MbProportion specifies a share of available memory bandwidth. It's an
                                    integer value followed by a unit. Two units are supported:

                                    - percentage, e.g. `80%`
                                    - MBps, e.g. `1000MBps`
                                  type: string
                                type: array
                              description: MbaConfig contains the memory bandwidth
                                configuration for one partition or class.
                              type: object
                          type: object
                        description: Partitions configure cache partitions.
                        type: object
                      usePodQoSAsDefaultClass:
                        description: |-
                          usePodQoSAsDefaultClass controls whether a container's Pod QoS
                          class is used as its RDT class, if this is otherwise unset.
                        type: boolean
                    type: object
                type: object
              idleCPUClass:
                description: |-
                  IdleCpuClass controls how unusded CPUs outside any a
                  balloons are (re)configured.
                type: string
              instrumentation:
                description: Config provides runtime configuration for instrumentation.
                properties:
                  httpEndpoint:
                    description: |-
                      HTTPEndpoint is the address our HTTP server listens on. This endpoint is used
                      to expose Prometheus metrics among other things.
                    example: :8891
                    type: string
                  metrics:
                    default:
                      enabled:
                      - policy
                      - buildinfo
                    description: Metrics defines which metrics to collect.
                    properties:
                      enabled:
                        description: Enabled enables collection for metrics matched
                          by glob patterns.
                        example:
                        - '*'
                        items:
                          type: string
                        type: array
                      polled:
                        description: Polled forces polled collection for metrics matched
                          by glob patterns.
                        example:
                        - computationally-expensive-metrics
                        items:
                          type: string
                        type: array
                    type: object
                  prometheusExport:
                    description: PrometheusExport enables exporting /metrics for Prometheus.
                    type: boolean
                  reportPeriod:
                    default: 30s
                    description: ReportPeriod is the interval between collecting polled
                      metrics.
                    format: duration
                    type: string
                  samplingRatePerMillion:
                    description: SamplingRatePerMillion is the number of samples to
                      collect per million spans.
                    example: 100000
                    type: integer
                  tracingCollector:
                    description: |-
                      TracingCollector defines the external endpoint for tracing data collection.
                      Endpoints are specified as full URLs, or as plain URL schemes which then
                      imply scheme-specific defaults. The supported schemes and their default
                      URLs are:
                        - otlp-http, http: localhost:4318
                        - otlp-grpc, grpc: localhost:4317
                    example: otlp-http://localhost:4318
                    type: string
                type: object
              loadClasses:
                description: LoadClasses specify available loads in balloon types.
                items:
                  description: |-
                    LoadClass specifies how a load affects the system and load
                    generating containers themselves.
                  properties:
                    level:
                      description: Level specifies hardware topology level loaded
                        by loads in this class.
                      enum:
                      - l2cache
                      - core
                      type: string
                    name:
                      description: Name of the load class.
                      type: string
                    overloadsLevelInBalloon:
                      description: |-
                        OverloadsLevelInBalloon controls whether containers in the
                        same balloon should avoid the load generated by themselves.
                        The default is false: CPUs for a balloon that generates
                        this load can be selected as close each other as
                        possible. Set to true, for instance, to select only one
                        hyperthread per core or only one CPU per L2 cache block in
                        to a balloon. Unselected CPUs from these domains can be
                        selected into balloons that do not load the same level.
                      type: boolean
                  required:
                  - level
                  - name
                  type: object
                type: array
              log:
                properties:
                  debug:
                    description: Debub turns on debug messages matching listed logger
                      sources.
                    items:
                      type: string
                    type: array
                  klog:
                    description: Klog configures the klog backend.
                    properties:
                      add_dir_header:
                        type: boolean
                      alsologtostderr:
                        type: boolean
                      log_backtrace_at:
                        type: string
                      log_dir:
                        type: string
                      log_file:
                        type: string
                      log_file_max_size:
                        format: int64
                        type: integer
                      logtostderr:
                        type: boolean
                      one_output:
                        type: boolean
                      skip_headers:
                        type: boolean
                      skip_log_headers:
                        type: boolean
                      stderrthreshold:
                        type: string
                      v:
                        type: integer
                      vmodule:
                        type: string
                    type: object
                  source:
                    description: Source controls whether messages are prefixed with
                      their logger source.
                    type: boolean
                type: object
              pinCPU:
                default: true
                description: PinCPU controls pinning containers to CPUs.
                type: boolean
              pinMemory:
                default: true
                description: PinMemory controls pinning containers to memory nodes.
                type: boolean
              preferSpreadOnPhysicalCores:
                description: |-
                  PreferSpreadOnPhysicalCores prefers allocating logical CPUs
                  (possibly hyperthreads) for a balloon from separate physical CPU
                  cores. This prevents workloads in the balloon from interfering with
                  themselves as they do not compete on the resources of the same CPU
                  cores. On the other hand, it allows more interference between
                  workloads in different balloons. The default is false: balloons
                  are packed tightly to a minimum number of physical CPU cores. The
                  value set here is the default for all balloon types, but it can be
                  overridden with the balloon type specific setting with the same
                  name.
                type: boolean
              preserve:
                description: |-
                  Preserve specifies containers whose resource pinning must not be
                  modified by the policy.
                properties:
                  matchExpressions:
                    description: MatchExpressions specifies one or more expressions.
                    items:
                      description: |-
                        Expression describes some runtime-evaluated condition. An expression
                        consists of a key, an operator and a set of values. An expression is
                        evaluated against an object which implements the Evaluable interface.
                        Evaluating an expression consists of looking up the value for the key
                        in the object, then using the operator to check it against the values
                        of the expression. The result is a single boolean value. An object is
                        said to satisfy the evaluated expression if this value is true. An
                        expression can contain 0, 1 or more values depending on the operator.
                      properties:
                        key:
                          description: Key is the expression key.
                          type: string
                        operator:
                          description: Op is the expression operator.
                          enum:
                          - Equals
                          - NotEqual
                          - In
                          - NotIn
                          - Exists
                          - NotExist
                          - AlwaysTrue
                          - Matches
                          - MatchesNot
                          - MatchesAny
                          - MatchesNone
                          type: string
                        values:
                          description: Values contains the values the key value is
                            evaluated against.
                          items:
                            type: string
                          type: array
                      required:
                      - key
                      - operator
                      type: object
                    type: array
                type: object
              reservedPoolNamespaces:
                description: |-
                  ReservedPoolNamespaces is a list of namespace globs that
                  will be allocated to reserved CPUs.
                items:
                  type: string
                type: array
              reservedResources:
                additionalProperties:
                  type: string
                description: Reserved (CPU) resources for kube-system namespace.
                type: object
              showContainersInNrt:
                description: |-
                  ShowContainersInNrt controls whether containers in balloons
                  are exposed as part of NodeResourceTopology. If true,
                  noderesourcetopologies.topology.node.k8s.io custom
                  resources provide visibility to CPU and memory affinity of
                  containers assigned into balloons on any node. The default
                  is false. Use balloon-type option with the same name to
                  override the policy-level default. Exposing affinities of
                  all containers on all nodes may generate a lot of traffic
                  and large CR object updates to Kubernetes API server. This
                  options has no effect unless agent:NodeResourceTopology
                  enables basic topology exposure.
                type: boolean
            required:
            - reservedResources
            type: object
          status:
            description: ConfigStatus is the per-node status for a configuration resource.
            properties:
              nodes:
                additionalProperties:
                  description: NodeStatus is the configuration status for a single
                    node.
                  properties:
                    errors:
                      description: Error can provide further details of a configuration
                        error.
                      type: string
                    generation:
                      description: Generation is the generation the configuration
                        this status was set for.
                      format: int64
                      type: integer
                    status:
                      description: Status of activating the configuration on this
                        node.
                      enum:
                      - Success
                      - Failure
                      type: string
                    timestamp:
                      description: Timestamp of setting this status.
                      format: date-time
                      type: string
                  required:
                  - generation
                  - status
                  type: object
                type: object
            required:
            - nodes
            type: object
        required:
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: null
  storedVersions: null
