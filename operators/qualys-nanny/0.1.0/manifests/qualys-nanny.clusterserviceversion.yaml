apiVersion: operators.coreos.com/v1
kind: ClusterServiceVersion
metadata:
  annotations:
    alm-examples: |-
      [
        {
          "apiVersion": "qualys.io/v1",
          "kind": "QualysContainerSecurity",
          "metadata": {
            "labels": {
              "app.kubernetes.io/managed-by": "kustomize",
              "app.kubernetes.io/name": "qualys-nanny"
            },
            "name": "qualys-container-security",
            "namespace": "qualys"
          },
          "spec": {
            "admissionController": {
              "enabled": false,
              "failurePolicy": "Ignore",
              "image": {
                "repository": "qualys/admission-controller",
                "tag": "1.1.2-0"
              },
              "replicas": 2
            },
            "clusterSensor": {
              "cloudProvider": "AWS",
              "clusterName": "my-cluster",
              "enabled": true,
              "hostScanner": {
                "enabled": true,
                "runOnMaster": true
              },
              "image": {
                "repository": "qualys/cluster-sensor",
                "tag": "1.4.0-0"
              },
              "k8sCompliance": true,
              "replicas": 1
            },
            "containerSensor": {
              "enabled": true,
              "image": {
                "pullPolicy": "IfNotPresent",
                "repository": "qualys/qcs-sensor",
                "tag": "latest"
              },
              "k8sMode": true,
              "logging": {
                "logLevel": 3
              },
              "mode": "general",
              "privilegeMode": "standard",
              "scanning": {
                "enableContainerScan": true,
                "enableImageScan": true,
                "enableScaScan": true,
                "scanThreadPoolSize": 2
              },
              "storage": {
                "storageSize": "10Gi",
                "usePersistentStorage": true
              }
            },
            "platformConfigRef": {
              "name": "qualys-platform"
            },
            "runtimeSensor": {
              "enabled": false
            },
            "scheduling": {
              "nodeSelector": {
                "kubernetes.io/os": "linux"
              },
              "priorityClassName": "system-node-critical",
              "tolerations": [
                {
                  "effect": "NoSchedule",
                  "operator": "Exists"
                },
                {
                  "effect": "NoExecute",
                  "operator": "Exists"
                }
              ]
            }
          }
        },
        {
          "apiVersion": "qualys.io/v1",
          "kind": "QualysContainerSecurity",
          "metadata": {
            "labels": {
              "app.kubernetes.io/managed-by": "kustomize",
              "app.kubernetes.io/name": "qualys-nanny"
            },
            "name": "qualys-container-security-minimal",
            "namespace": "qualys"
          },
          "spec": {
            "admissionController": {
              "enabled": false
            },
            "clusterSensor": {
              "cloudProvider": "SELF_MANAGED_K8S",
              "clusterName": "my-cluster",
              "enabled": true,
              "image": {
                "repository": "qualys/cluster-sensor",
                "tag": "1.4.0-0"
              },
              "k8sCompliance": true,
              "replicas": 1
            },
            "containerSensor": {
              "enabled": true,
              "image": {
                "pullPolicy": "IfNotPresent",
                "repository": "qualys/qcs-sensor",
                "tag": "latest"
              },
              "k8sMode": true,
              "logging": {
                "logLevel": 3
              },
              "mode": "general",
              "privilegeMode": "minimal",
              "scanning": {
                "enableContainerScan": true,
                "enableImageScan": true,
                "enableScaScan": true,
                "scanThreadPoolSize": 2
              },
              "storage": {
                "storageSize": "10Gi",
                "usePersistentStorage": true
              }
            },
            "platformConfigRef": {
              "name": "qualys-platform"
            },
            "runtimeSensor": {
              "enabled": false
            },
            "scheduling": {
              "nodeSelector": {
                "kubernetes.io/os": "linux"
              },
              "priorityClassName": "system-node-critical",
              "tolerations": [
                {
                  "effect": "NoSchedule",
                  "operator": "Exists"
                },
                {
                  "effect": "NoExecute",
                  "operator": "Exists"
                }
              ]
            }
          }
        },
        {
          "apiVersion": "qualys.io/v1",
          "kind": "QualysContainerSecurity",
          "metadata": {
            "labels": {
              "app.kubernetes.io/managed-by": "kustomize",
              "app.kubernetes.io/name": "qualys-nanny"
            },
            "name": "qualys-container-security-privileged",
            "namespace": "qualys"
          },
          "spec": {
            "admissionController": {
              "enabled": true,
              "failurePolicy": "Ignore",
              "image": {
                "repository": "qualys/admission-controller",
                "tag": "1.1.2-0"
              },
              "replicas": 2
            },
            "clusterSensor": {
              "cloudProvider": "AWS",
              "clusterName": "my-cluster",
              "enabled": true,
              "hostScanner": {
                "enabled": true,
                "runOnMaster": true
              },
              "image": {
                "repository": "qualys/cluster-sensor",
                "tag": "1.4.0-0"
              },
              "k8sCompliance": true,
              "replicas": 1
            },
            "containerSensor": {
              "enabled": true,
              "image": {
                "pullPolicy": "IfNotPresent",
                "repository": "qualys/qcs-sensor",
                "tag": "latest"
              },
              "k8sMode": true,
              "logging": {
                "logLevel": 3
              },
              "mode": "general",
              "privilegeMode": "privileged",
              "scanning": {
                "enableContainerScan": true,
                "enableImageScan": true,
                "enableScaScan": true,
                "scanThreadPoolSize": 2
              },
              "storage": {
                "storageSize": "10Gi",
                "usePersistentStorage": true
              }
            },
            "platformConfigRef": {
              "name": "qualys-platform"
            },
            "runtimeSensor": {
              "enabled": true,
              "image": {
                "repository": "qualys/runtime-sensor",
                "tag": "1.4.0-0"
              },
              "logging": {
                "logLevel": 3
              },
              "resources": {
                "limits": {
                  "cpu": "800m",
                  "memory": "1024Mi"
                },
                "requests": {
                  "cpu": "500m",
                  "memory": "1024Mi"
                }
              }
            },
            "scheduling": {
              "nodeSelector": {
                "kubernetes.io/os": "linux"
              },
              "priorityClassName": "system-node-critical",
              "tolerations": [
                {
                  "effect": "NoSchedule",
                  "operator": "Exists"
                },
                {
                  "effect": "NoExecute",
                  "operator": "Exists"
                }
              ]
            }
          }
        },
        {
          "apiVersion": "qualys.io/v1",
          "kind": "QualysContainerSecurity",
          "metadata": {
            "labels": {
              "app.kubernetes.io/managed-by": "kustomize",
              "app.kubernetes.io/name": "qualys-nanny"
            },
            "name": "qualys-container-security-unprivileged",
            "namespace": "qualys"
          },
          "spec": {
            "admissionController": {
              "enabled": false
            },
            "clusterSensor": {
              "cloudProvider": "SELF_MANAGED_K8S",
              "clusterName": "my-cluster",
              "enabled": true,
              "image": {
                "repository": "qualys/cluster-sensor",
                "tag": "1.4.0-0"
              },
              "k8sCompliance": true,
              "replicas": 1
            },
            "containerSensor": {
              "enabled": true,
              "image": {
                "pullPolicy": "IfNotPresent",
                "repository": "qualys/qcs-sensor",
                "tag": "latest"
              },
              "k8sMode": true,
              "logging": {
                "logLevel": 3
              },
              "mode": "general",
              "privilegeMode": "unprivileged",
              "scanning": {
                "enableContainerScan": true,
                "enableImageScan": true,
                "enableScaScan": true,
                "scanThreadPoolSize": 2
              },
              "security": {
                "runtimeSocketGroup": 0
              },
              "storage": {
                "usePersistentStorage": false
              }
            },
            "platformConfigRef": {
              "name": "qualys-platform"
            },
            "runtimeSensor": {
              "enabled": false
            },
            "scheduling": {
              "nodeSelector": {
                "kubernetes.io/os": "linux"
              },
              "priorityClassName": "system-node-critical",
              "tolerations": [
                {
                  "effect": "NoSchedule",
                  "operator": "Exists"
                },
                {
                  "effect": "NoExecute",
                  "operator": "Exists"
                }
              ]
            }
          }
        },
        {
          "apiVersion": "qualys.io/v1",
          "kind": "QualysContainerSecurity",
          "metadata": {
            "name": "qualys-recommended",
            "namespace": "qualys"
          },
          "spec": {
            "admissionController": {
              "enabled": false
            },
            "clusterSensor": {
              "cloudProvider": "SELF_MANAGED_K8S",
              "clusterName": "my-cluster",
              "enabled": true,
              "hostScanner": {
                "enabled": true,
                "runOnMaster": true
              },
              "image": {
                "repository": "qualys/cluster-sensor",
                "tag": "1.4.0-0"
              },
              "k8sCompliance": true
            },
            "containerSensor": {
              "enabled": true,
              "image": {
                "pullPolicy": "IfNotPresent",
                "repository": "qualys/qcs-sensor",
                "tag": "latest"
              },
              "k8sMode": true,
              "mode": "general",
              "privilegeMode": "standard",
              "scanning": {
                "enableContainerScan": true,
                "enableImageScan": true,
                "enableScaScan": true
              },
              "storage": {
                "usePersistentStorage": true
              }
            },
            "platformConfigRef": {
              "name": "qualys-platform"
            },
            "runtimeSensor": {
              "enabled": false
            },
            "scheduling": {
              "nodeSelector": {
                "kubernetes.io/os": "linux"
              },
              "tolerations": [
                {
                  "effect": "NoSchedule",
                  "operator": "Exists"
                },
                {
                  "effect": "NoExecute",
                  "operator": "Exists"
                }
              ]
            }
          }
        },
        {
          "apiVersion": "qualys.io/v1",
          "kind": "QualysPlatformConfig",
          "metadata": {
            "labels": {
              "app.kubernetes.io/managed-by": "kustomize",
              "app.kubernetes.io/name": "qualys-nanny"
            },
            "name": "qualys-platform"
          },
          "spec": {
            "credentials": {
              "secretRef": {
                "name": "qualys-credentials",
                "namespace": "qualys"
              },
              "sourceType": "secret"
            },
            "platform": {
              "gatewayUrl": "https://gateway.qg1.apps.qualys.ca",
              "serverUri": "https://cmsqagpublic.qg1.apps.qualys.ca/ContainerSensor"
            }
          }
        }
      ]
    capabilities: Full Lifecycle
    categories: Security
    containerImage: quay.io/nelssec/qualys-nanny:v0.1.0
    createdAt: "2026-01-25T16:40:50Z"
    description: Automatically deploy and manage Qualys Container Security Sensor
      on OpenShift clusters
    operators.operatorframework.io/builder: operator-sdk-v1.42.0
    operators.operatorframework.io/project_layout: go.kubebuilder.io/v4
    repository: https://github.com/nelssec/qualys-nanny
    support: NelsSec
  name: qualys-nanny.v0.1.0
  namespace: placeholder
spec:
  apiservicedefinitions: {}
  customresourcedefinitions:
    owned:
    - description: Deploys and manages Qualys security sensors including Container Sensor, Cluster Sensor, Admission Controller, and Runtime Sensor for vulnerability scanning and compliance monitoring.
      displayName: Qualys Container Security
      kind: QualysContainerSecurity
      name: qualyscontainersecurities.qualys.io
      version: v1
    - description: Configures Qualys platform connection settings including server URLs, gateway endpoints, and credential references for authenticating with Qualys Cloud Platform.
      displayName: Qualys Platform Config
      kind: QualysPlatformConfig
      name: qualysplatformconfigs.qualys.io
      version: v1
  description: |
    ## Qualys Nanny Operator

    The Qualys Nanny Operator automatically deploys and manages Qualys security agents on OpenShift clusters.

    ### Features

    - **Container Security Sensor**: Container image and runtime scanning
    - **Cluster Sensor**: Kubernetes compliance and vulnerability scanning
    - **Multiple Privilege Modes**: Unprivileged, minimal, standard, and privileged modes
    - **OpenShift Integration**: Automatic SecurityContextConstraints management
    - **Flexible Credentials**: Support for Kubernetes Secrets and External Secrets Operator

    ### Prerequisites

    - OpenShift 4.12+
    - Qualys subscription with Container Security
    - Qualys activation ID and customer ID

    ### Getting Started

    1. Create a Secret with your Qualys credentials:
       ```yaml
       apiVersion: v1
       kind: Secret
       metadata:
         name: qualys-credentials
         namespace: qualys
       type: Opaque
       stringData:
         ACTIVATION_ID: "your-activation-id"
         CUSTOMER_ID: "your-customer-id"
       ```

    2. Create a QualysPlatformConfig:
       ```yaml
       apiVersion: qualys.io/v1
       kind: QualysPlatformConfig
       metadata:
         name: qualys-platform
       spec:
         platform:
           serverUri: "https://cmsqagpublic.qg2.apps.qualys.com/ContainerSensor"
         credentials:
           sourceType: secret
           secretRef:
             name: qualys-credentials
             namespace: qualys
       ```

    3. Deploy the Container Security Sensor by creating a QualysContainerSecurity CR.
  displayName: Qualys Nanny
  icon:
  - base64data: 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
    mediatype: image/png
  install:
    spec:
      clusterPermissions:
      - rules:
        - apiGroups:
          - ""
          resources:
          - configmaps
          - endpoints
          - namespaces
          - nodes
          - nodes/status
          - pods
          - pods/exec
          - pods/status
          - replicationcontrollers/status
          - secrets
          - serviceaccounts
          - services
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - ""
          resources:
          - events
          verbs:
          - create
          - patch
        - apiGroups:
          - '*'
          resources:
          - '*'
          verbs:
          - get
          - list
        - apiGroups:
          - admissionregistration.k8s.io
          resources:
          - validatingwebhookconfigurations
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - apps
          resources:
          - daemonsets
          - daemonsets/status
          - deployments
          - deployments/status
          - replicasets
          - replicasets/status
          - statefulsets
          - statefulsets/status
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - batch
          resources:
          - cronjobs
          - cronjobs/status
          - jobs
          - jobs/status
          verbs:
          - create
          - delete
          - get
          - list
          - watch
        - apiGroups:
          - discovery.k8s.io
          resources:
          - endpointslices
          verbs:
          - get
          - list
          - watch
        - apiGroups:
          - networking.k8s.io
          resources:
          - ingresses
          - networkpolicies
          verbs:
          - get
          - list
          - watch
        - apiGroups:
          - policy
          resources:
          - podsecuritypolicies
          verbs:
          - get
          - list
          - watch
        - apiGroups:
          - qualys.io
          resources:
          - qualyscontainersecurities
          - qualysplatformconfigs
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - qualys.io
          resources:
          - qualyscontainersecurities/finalizers
          - qualysplatformconfigs/finalizers
          verbs:
          - update
        - apiGroups:
          - qualys.io
          resources:
          - qualyscontainersecurities/status
          - qualysplatformconfigs/status
          verbs:
          - get
          - patch
          - update
        - apiGroups:
          - rbac.authorization.k8s.io
          resources:
          - clusterrolebindings
          - clusterroles
          - rolebindings
          - roles
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - authentication.k8s.io
          resources:
          - tokenreviews
          verbs:
          - create
        - apiGroups:
          - authorization.k8s.io
          resources:
          - subjectaccessreviews
          verbs:
          - create
        serviceAccountName: qualys-controller-manager
      deployments:
      - label:
          app.kubernetes.io/managed-by: kustomize
          app.kubernetes.io/name: qualys-nanny
          control-plane: controller-manager
        name: qualys-controller-manager
        spec:
          replicas: 1
          selector:
            matchLabels:
              app.kubernetes.io/name: qualys-nanny
              control-plane: controller-manager
          strategy: {}
          template:
            metadata:
              annotations:
                kubectl.kubernetes.io/default-container: manager
              labels:
                app.kubernetes.io/name: qualys-nanny
                control-plane: controller-manager
            spec:
              containers:
              - args:
                - --metrics-bind-address=:8443
                - --leader-elect
                - --health-probe-bind-address=:8081
                command:
                - /manager
                image: quay.io/nelssec/qualys-nanny:v0.1.0
                livenessProbe:
                  httpGet:
                    path: /healthz
                    port: 8081
                  initialDelaySeconds: 15
                  periodSeconds: 20
                name: manager
                readinessProbe:
                  httpGet:
                    path: /readyz
                    port: 8081
                  initialDelaySeconds: 5
                  periodSeconds: 10
                resources:
                  limits:
                    cpu: 500m
                    memory: 128Mi
                  requests:
                    cpu: 10m
                    memory: 64Mi
                securityContext:
                  allowPrivilegeEscalation: false
                  capabilities:
                    drop:
                    - ALL
              securityContext:
                runAsNonRoot: true
                seccompProfile:
                  type: RuntimeDefault
              serviceAccountName: qualys-controller-manager
              terminationGracePeriodSeconds: 10
      permissions:
      - rules:
        - apiGroups:
          - ""
          resources:
          - configmaps
          verbs:
          - get
          - list
          - watch
          - create
          - update
          - patch
          - delete
        - apiGroups:
          - coordination.k8s.io
          resources:
          - leases
          verbs:
          - get
          - list
          - watch
          - create
          - update
          - patch
          - delete
        - apiGroups:
          - ""
          resources:
          - events
          verbs:
          - create
          - patch
        serviceAccountName: qualys-controller-manager
    strategy: deployment
  installModes:
  - supported: true
    type: OwnNamespace
  - supported: true
    type: SingleNamespace
  - supported: false
    type: MultiNamespace
  - supported: true
    type: AllNamespaces
  keywords:
  - security
  - qualys
  - vulnerability
  - compliance
  - container security
  - openshift
  links:
  - name: Qualys
    url: https://www.qualys.com
  - name: Documentation
    url: https://github.com/nelssec/qualys-nanny
  maintainers:
  - email: support@nelssec.io
    name: NelsSec
  maturity: alpha
  minKubeVersion: 1.25.0
  provider:
    name: NelsSec
    url: https://github.com/nelssec
  version: 0.1.0
